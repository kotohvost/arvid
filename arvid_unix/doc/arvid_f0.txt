─ SU.HARDW.SUPPORT.ARVID (2:5050/17.1) ──────────────── SU.HARDW.SUPPORT.ARVID ─
 Кто   : Alexey Kuzmin                       2:5055/29.17    Mon 10 Mar 97 03:57 
 О чем : Аpвид и посекторный backup винта                                       
────────────────────────────────────────────────────────────────────────────────

  Вот вам свежесочиненная моя вещь. Все вопpосы, замечания, благодаpности
ОБЯЗАТЕЛЬHО дублиpуйте мылом, в пpотивном случае Вы pискуете ответа не
дождаться - вpемени нет :(.

=== Cut ===

Часть FAQ. Версия 0.9a от марта 1997 года. Alexey Kuzmin 2:5055/29.17@Fidonet

  ТЕОРИЯ. КАК ЗАСТРАХОВАТЬСЯ или копия винта - без проблем?

  Ясно, что позволить себе не делать резервных копий могут только те, у
кого АРВИДа сроду не было. Все АРВИДовладельцы возможностью сделать копию
своей информации в той или иной степени пользуются. Существуют два различных
варианта создания резервных копий:
  1. Пофайловый сброс диска.
  2. Сброс образа диска.

  1. При первом способе на кассету и обратно отправляются существующие на
диске файлы. Изначально АРВИДовсий soft решает именно эту задачу.
Достоинства метода:
  а) Можно сделать копию только той части файлов, которая нужна. Hапример,
если у вас на диске постоянно изменяется только \job\*.*, то только его и
надо бросать на ленту.
  б) следствие а). Объем backup не зависит от размера диска. Если на 2Gb
диске занято или изменилось 20mb, то только эти 20mb и будут скопированы.
  в) целостность файла, способность к размножению на файловом уровне. :)
  Hедостатки следующие:
  а) При крахе всей файловой структуры до момента установки базовой операцион-
ной системы и софта АРВИДа (А это, например, для win95 примерно час-два) весь
эффект сделанного недавно backup совершенно неощутим.
  Причем базовая операционная система (т.е. та, через которую арвид работатет)
должна АРВИД любить и знать. Hа текущий момент это только DOS или DOS-сессия.
Для АРВИДов 1031 & 1052, в добавок WIN95 & OS/2. Для 1010 - UNIX (написан не в
КСИ, работает только на чтение).
  б) переностимость Long Names и русских имен. Сложная проблема, вызванная
изначальной ориентировкой на DOS. DOS-Software не хочет понимать длинные имена
ни WIN95, ни чего-либо еще. Про UNIX-овый формат данных и речи нет. А
работать-то хочется, посему придумываются разные пути. DOSLFN10.zip ставят.
WINRAR-ом русские имена в RUS_NAME.RAR запаковывают, а потом этот RUS_NAME
кладут на ленту.
  в) swap, shared и прочие FILE сбросить невозможно.

  2. Сброс образа диска.
  Прямо противоположная первому способу процедура. ВСЕ сектора винчестера
копируются на ленту. Достоинства:
  а) RESTORE восстанавливает винчестер с "точностью до байта"
  б) За один прием возможно сделать BACKUP винчестера, на котором стоят
DOS+UNIX+OS/2+NETWARE, и они (UNIX, etc) этого не заметят.
  в) Проблемы с LONG NAMES и прочим изчезают в принципе.
  г) Если делать все из DOS (а я про это и пишу), то способ работает на
любой модели АРВИДа, вплоть до 1010 :).
  едостатки следуют из достоинств:
  а) BACKUP-ить надо ВСЕ, независимо от того, надо это или не надо.
  б) RESTORE надо делать либо на тот же, либо на полностью аналогичный
винчестер.


  ПРАКТИКА. RAWDISK, Backup Warrior. Руководство по применению.

  Прежде чем Вы начнете читать дальше, возьмите с дистрибутивных дискет
(на BBS поддержки, на www, у друга, у автора, у меня) файлы:
  BWAR-A2.ZIP  - BackUp Warrior (Автор - Алекс Ермолович, 2:5020/747.4)
  RAWDISK.ZIP  - RawDisk        (Автор - какой-то немец ;)
                        Juergen Prang   (prang@du9ds4.fb9dv.uni-duisburg.de)

  Чего это такое? Это программы, которые помогают прикидываться файлами
штукам, файлами не являющимся :) А именно:
  BackUp Warrior позволяет прикинуться файлом любой Head любого Cyl.
  RAWDISK позволяется прикинуться файлом любому интервальному набору Cyl.
  В дальнейшем изложение ведется на примере RawDisk. Причины:
  - к BackUp Warrior есть русский текст документации, к rawdisk - нету(пока ;)
  - RawDisk,imho, удобнее.

  RAWDISK запускается так.
  device=c:\drv\rawdisk.sys /dr=1 /hd=15 /se=63 /sc=195 /ec=1000
  где: /dr: 0-Master или 1-Slave IDE HDD.
       /sc: стартовый цилиндр (0..1023)
       /ec: конечный цилиндр (0..1023)
       /hd: количество головок (0..63)
       /se: количество секторов на дорожке (0..63)

  По этой команде создается диск, с именем, следующим за последним в вашей
системе. Этот диск содержит ОДИH файл с именем RAWDISK.DAT. И в этом файле
содержаться сектора трэков от /sc до /ec. Ясно? Достаточно насоздавать вызовов
RAWDISK-a в своем CONFIG.SYS, чтоб они целиком покрывали винт, а потом слить
все это на ленту.

  Теперь о том, как проделать посекторный BACKUP и RESTORE винта.
  I. BACKUP
    1. Запоминаем геометрию винта (винт >528mb запускаем в LBA-mode)
    2. Делим количество трэков примерно на части по 100-200 мегабайт (больше
- не надо, учитывайте возможности АРВИДа).
    3. Правильно ставим вызовы RAWDISK.SYS в CONFIG.SYS.
    4. Грузимся в DOS (можно - с дискетки + RAMDRIVE)
    5. DOS-овым soft-ом сливаем файлики RAWDISK.DAT со всех получившихся
дисков на ленту.

  II. RESTORE
    1. Грузим DOS с дискетки с RAMDRIVE и правильным CONFIG.SYS
    2. Ставим ARVID SoftWare на RAMDRIVE диск
    3. Им же выплеваваем с ленты на свои места файлики backup-a.

  Известные мне ограничения RAWDISK:
  1. Разделы больше 528MB он не понимает. Это, конечно и не нужно, но все же.
  2. Винты >528MB работают ТОЛЬКО в LBA-mode.


  Вот и все. адеюсь, изложенные здесь знания верны и полезны. Отклики о bugs
пишите мне по адресу 2:5055/29.17.

=== Cut ===
